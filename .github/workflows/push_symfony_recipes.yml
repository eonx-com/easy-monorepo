name: Push Symfony Recipes

on:
    push:
        branches:
            - feature/eonx-symfony-recipes

defaults:
    run:
        shell: bash

jobs:
    push_symfony_recipes:
        name: Push Symfony Recipes
        runs-on: ubuntu-latest
        steps:
            -   uses: eonx-com/actions-checkout@v2

            -   name: Clone remote EonX Symfony Recipes repo
                run: |
                    git config --global user.email "nathan.page@eonx.com"
                    git config --global user.name "natepage"
                    git clone https://github.com/eonx-com/symfony-recipes.git .github/remote-repo

            -   name: Copy changes
                run: cp -TRv symfony-recipes/ .github/remote-repo/

            -   name: Commit and push changes to remote repo
                run: |
                    cd .github/remote-repo
                    git config -l | grep ''http\..*\.extraheader'' | cut -d= -f1 | xargs -L1 git config --unset-all
                    git add .
                    git commit -m 'Update Symfony Recipes' || true
                    git push origin -f push-from-monorepo
